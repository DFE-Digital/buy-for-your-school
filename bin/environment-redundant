#!/usr/bin/env ruby

blah = nil
for arg in ARGV
   blah = arg
end

def env_key_prefix(env)
  name = {
    staging: "STAGING",
    preview: "PREVIEW",
    research: "RESEARCH",
    production: "PROD",
  }[env]

  "APP_ENV_#{name}_"
end

%i[staging preview research production].each do |environment|
  keys = `gh secret list -e #{environment}`
    .split("\n")
    .map do |e|
      e.split("\t")
       .first
       .gsub(env_key_prefix(environment), "")
    end
  next unless keys.include?(blah)

  puts "#{environment.capitalize} has #{env_key_prefix(environment)}#{blah}"
end