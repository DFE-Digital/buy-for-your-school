<div class="<%= toggle_visibility?(scope) %>" id="<%= "filter-#{tab}" %>">
  <%= form_with model: form, scope: scope, url: filter_url, method: :get, class: "filter-case-form" do |form| %>
    <h2 class="govuk-heading-m">
      <%= I18n.t("support.case.filter.filter_results") %>
    </h2>

    <div class="govuk-grid-row">
      <% if tab == "all-cases" %>
        <div class="govuk-grid-column-one-quarter">
          <%= form.govuk_select :state,
                                options_for_select(Support::Case.states.keys.map { |s| [I18n.t("support.case.label.state.state_#{s.downcase}"), s] },
                                                   params.dig(scope, :state)),
                                options: { include_blank: false, prompt: I18n.t("support.case.filter.labels.all") },
                                label: { text: I18n.t("support.case.filter.labels.state") } %>
        </div>
      <% end %>

      <div class="govuk-grid-column-one-quarter">
        <%= form.govuk_select :category,
                              options_for_select(form.object.categories.map { |a| [a.title, a.id] },
                                                 params.dig(scope, :category)),
                              options: { include_blank: false, prompt: I18n.t("support.case.filter.labels.all") },
                              label: { text: I18n.t("support.case.filter.labels.sub_category") } %>
      </div>

      <div class="govuk-grid-column-one-quarter">
        <%= form.govuk_select :tower,
                              options_for_select(form.object.towers.map { |a| [a.title, a.id] },
                                                 params.dig(scope, :tower)),
                              options: { include_blank: false, prompt: I18n.t("support.case.filter.labels.all") },
                              label: { text: I18n.t("support.case.filter.labels.tower") } %>
      </div>

      <% if tab == "all-cases" %>
        <div class="govuk-grid-column-one-quarter">
          <%= form.govuk_select :agent,
                                options_for_select(form.object.agents.map { |a| [a.full_name, a.id] },
                                                   params.dig(scope, :agent)),
                                options: { include_blank: false, prompt: I18n.t("support.case.filter.labels.all") },
                                label: { text: I18n.t("support.case.filter.labels.assignee") } %>
        </div>
      <% end %>
    </div>

    <div class="govuk-grid-row">
      <div class="govuk-grid-column-three-quarters">
        <div class="govuk-button-group">
          <%= form.hidden_field :search_term, value: form.object.try(:search_term) %>
          <%= form.submit I18n.t("support.case.filter.buttons.apply"), class: "govuk-button govuk-button--secondary", role: "button" %>
          <%= link_to I18n.t("support.case.filter.buttons.clear"), clear_url, class: "govuk-button govuk-button--secondary", role: "button" %>
        </div>
      </div>
    </div>
  <% end %>
</div>
