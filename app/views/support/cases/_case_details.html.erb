<div role="tabpanel" aria-labelledby="tab_case-details">
  <h2 class="govuk-heading-m">
    <%= I18n.t("support.case.case_details.case_summary.heading") %>
    <%= link_to I18n.t("support.case.link.edit_case_summary"), edit_support_case_summary_path(current_case), class: "govuk-link" %>
  </h2>
  <dl class="govuk-summary-list govuk-!-margin-bottom-5">
    <div class="govuk-summary-list__row">
      <dt class="govuk-summary-list__key">
        <%= I18n.t("support.case.label.source.header") %>
      </dt>
      <dd class="govuk-summary-list__value">
        <% if current_case.source.present? %>
          <%= I18n.t("support.case.label.source.#{current_case.source}") %>
        <% else %>
          <%= I18n.t("support.case.label.source.unspecified") %>
        <% end %>
      </dd>
    </div>
    <div class="govuk-summary-list__row">
      <dt class="govuk-summary-list__key">
        <%= I18n.t("support.case.label.support_level.header") %>
      </dt>
      <dd class="govuk-summary-list__value">
        <% if current_case.support_level.present? %>
          <%= I18n.t("support.case.label.support_level.#{current_case.support_level}") %>
        <% else %>
          <%= I18n.t("support.case.label.support_level.unspecified") %>
        <% end %>
      </dd>
    </div>

    <div class="govuk-summary-list__row">
      <dt class="govuk-summary-list__key">
        <%= I18n.t("support.case.label.case_value") %>
      </dt>
      <dd class="govuk-summary-list__value">
        <% if current_case.value.present? %>
          &#163;<%= current_case.value %>
        <% else %>
          <%= I18n.t("support.case.label.value.unspecified") %>
        <% end %>
      </dd>
    </div>
  </dl>

  <dl class="govuk-summary-list govuk-!-margin-bottom-5">
    <h2 class="govuk-heading-m"><%= I18n.t("support.case.case_details.request.heading") %></h2>
    <div class="govuk-summary-list__row">
      <dt class="govuk-summary-list__key">
        <%= I18n.t("support.case.label.received_at") %>
      </dt>
      <dd class="govuk-summary-list__value">
        <%= current_case.received_at %>
      </dd>
    </div>

    <% if current_case.category.present? %>
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          <%= I18n.t("support.case.label.category") %>
        </dt>
        <dd class="govuk-summary-list__value">
          <%= current_case.category.title %>
        </dd>
        <dd class="govuk-summary-list__actions">
          <%= link_to I18n.t("support.case.link.edit_category"), edit_support_case_categorisation_path(current_case), class: "govuk-link" %>
        </dd>
      </div>
    <% end %>

    <% if current_case.query.present? %>
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          <%= I18n.t("support.case.label.query") %>
        </dt>
        <dd class="govuk-summary-list__value">
          <%= current_case.query.title %>
        </dd>
        <dd class="govuk-summary-list__actions">
          <%= link_to I18n.t("support.case.link.edit_category"), edit_support_case_categorisation_path(current_case), class: "govuk-link" %>
        </dd>
      </div>
    <% end %>

    <div class="govuk-summary-list__row">
      <dt class="govuk-summary-list__key">
        <%= I18n.t("support.case.label.problem_description") %>
      </dt>
      <dd class="govuk-summary-list__value">
        <%= current_case.request_text %>
      </dd>
      <dd class="govuk-summary-list__actions">
        <% if current_case.created_manually? %>
          <%= link_to I18n.t("support.case.link.edit_description"), edit_support_case_path(current_case), class: "govuk-link" %>
        <% end %>
      </dd>
    </div>

    <div class="govuk-summary-list__row">
      <dt class="govuk-summary-list__key">
        <%= I18n.t("support.case.label.attached_specification") %>
      </dt>
      <dd class="govuk-summary-list__value">
        <% unless current_case.documents.for_rendering.any? %>
          <%= I18n.t("support.case.label.attached_specification_none") %>
        <% end %>

        <% current_case.documents.for_rendering.each.with_index(1) do |document, i| %>
          <%= link_to "specification-#{i} #{I18n.t("support.generic.link.opens_in_new_tab")}",
                support_case_document_path(@current_case, document),
                class: "govuk-link", target: "_blank", rel: "noreferrer noopener" %>
        <% end %>
      </dd>
      <dd class="govuk-summary-list__actions"></dd>
    </div>
  </dl>
<div role="tabpanel" aria-labelledby="procurement-details-procurement">
    <h2 id="procurement-details-procurement" class="govuk-heading-m">
      <%= I18n.t("support.case.header.procurement_detail") %>
      <% if @current_case.procurement %>
        - <%= link_to I18n.t("support.case.label.procurement_details.change"), edit_support_case_procurement_details_path(@current_case), class: "govuk-link"%>
      <% end %>
    </h2>
    <dl class="govuk-summary-list govuk-!-margin-bottom-5">
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          <%= I18n.t("support.case.label.procurement_details.required_agreement_type") %>
        </dt>
        <dt class="govuk-summary-list__value">
          <%= @current_case.procurement&.required_agreement_type %>
        </dt>
      </div>
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          <%= I18n.t("support.case.label.procurement_details.route_to_market") %>
        </dt>
        <dt class="govuk-summary-list__value">
          <%= @current_case.procurement&.route_to_market %>
        </dt>
      </div>
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          <%= I18n.t("support.case.label.procurement_details.reason_for_route_to_market") %>
        </dt>
        <dt class="govuk-summary-list__value">
          <%= @current_case.procurement&.reason_for_route_to_market %>
        </dt>
      </div>
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          <%= I18n.t("support.case.label.procurement_details.framework_name") %>
        </dt>
        <dt class="govuk-summary-list__value">
          <%= @current_case.procurement&.framework_name %>
        </dt>
      </div>
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          <%= I18n.t("support.case.label.procurement_details.procurement_start_date") %>
        </dt>
        <dt class="govuk-summary-list__value">
          <%= @current_case.procurement&.started_at %>
        </dt>
      </div>
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          <%= I18n.t("support.case.label.procurement_details.procurement_end_date") %>
        </dt>
        <dt class="govuk-summary-list__value">
          <%= @current_case.procurement&.ended_at %>
        </dt>
      </div>
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          <%= I18n.t("support.case.label.procurement_details.procurement_stage") %>
        </dt>
        <dt class="govuk-summary-list__value">
          <%= @current_case.procurement&.stage %>
        </dt>
      </div>
    </dl>
</div>

<div role="tabpanel" aria-labelledby="pd-existing-contract">
  <h2 id="pd-existing-contract" class="govuk-heading-m">Existing contract details -
  <%= link_to I18n.t("support.case.label.procurement_details.change"), edit_support_case_contract_path(@current_case, @current_case.existing_contract), class: "govuk-link" %></h2>
  <dl class="govuk-summary-list govuk-!-margin-bottom-5">
    <div class="govuk-summary-list__row">
      <dt class="govuk-summary-list__key">
        <%= I18n.t("support.case.label.procurement_details.end_date") %>
      </dt>
      <dt class="govuk-summary-list__value">
        <%= @current_case.existing_contract&.ended_at %>
      </dt>
    </div>
    <div class="govuk-summary-list__row">
      <dt class="govuk-summary-list__key">
        <%= I18n.t("support.case.label.procurement_details.contract_duration") %>
      </dt>
       <dt class="govuk-summary-list__value">
        <%= @current_case.existing_contract&.duration %>
      </dt>
    </div>
    <div class="govuk-summary-list__row">
      <dt class="govuk-summary-list__key">
        <%= I18n.t("support.case.label.procurement_details.contract_spend") %>
      </dt>
      <dt class="govuk-summary-list__value">
        <%= @current_case.existing_contract&.spend %>
      </dt>
    </div>
    <div class="govuk-summary-list__row">
      <dt class="govuk-summary-list__key">
        <%= I18n.t("support.case.label.procurement_details.supplier") %>
      </dt>
       <dt class="govuk-summary-list__value">
        <%= @current_case.existing_contract&.supplier %>
      </dt>
    </div>
  </dl>
</div>

  <div role="tabpanel" aria-labelledby="pd-new-contract">
    <h2 id="pd-new-contract" class="govuk-heading-m">New contract details -
    <%= link_to I18n.t("support.case.label.procurement_details.change"), edit_support_case_contract_path(@current_case, @current_case.new_contract_id), class: "govuk-link"%></h2>
      <dl class="govuk-summary-list govuk-!-margin-bottom-5">
        <div class="govuk-summary-list__row">
          <dt class="govuk-summary-list__key">
            <%= I18n.t("support.case.label.procurement_details.start_date") %>
          </dt>
          <dt class="govuk-summary-list__value">
            <%= @current_case.new_contract&.started_at %>
          </dt>
        </div>
        <div class="govuk-summary-list__row">
          <dt class="govuk-summary-list__key">
            <%= I18n.t("support.case.label.procurement_details.contract_duration") %>
          </dt>
          <dt class="govuk-summary-list__value">
            <%= @current_case.new_contract&.duration %>
          </dt>
        </div>
        <div class="govuk-summary-list__row">
          <dt class="govuk-summary-list__key">
            <%= I18n.t("support.case.label.procurement_details.contract_spend") %>
          </dt>
          <dt class="govuk-summary-list__value">
            <%= @current_case.new_contract&.spend %>
          </dt>
        </div>
        <div class="govuk-summary-list__row">
          <dt class="govuk-summary-list__key">
            <%= I18n.t("support.case.label.procurement_details.supplier") %>
          </dt>
          <dt class="govuk-summary-list__value">
            <%= @current_case.new_contract&.supplier %>
          </dt>
        </div>
      </dl>
    </div>

  <div role="tabpanel" aria-labelledby="pd-savings">
    <h2 id="pd-savings" class="govuk-heading-m"><%= I18n.t("support.case_savings.show.header") %> - <%= link_to I18n.t("support.case_savings.show.link"), edit_support_case_savings_path(@current_case), class: "govuk-link"%></h2>
    <dl class="govuk-summary-list govuk-!-margin-bottom-5">
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          <%= I18n.t("support.case.label.procurement_details.savings_status") %>
        </dt>
        <dt class="govuk-summary-list__value">
          <%= @current_case.savings_status %>
        </dt>
      </div>
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          <%= I18n.t("support.case.label.procurement_details.savings_estimate_method") %>
        </dt>
        <dt class="govuk-summary-list__value">
          <%= @current_case.savings_estimate_method %>
        </dt>
      </div>
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          <%= I18n.t("support.case.label.procurement_details.savings_actual_method") %>
        </dt>
        <dt class="govuk-summary-list__value">
          <%= @current_case.savings_actual_method %>
        </dt>
      </div>
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          <%= I18n.t("support.case.label.procurement_details.savings_estimate") %>
        </dt>
        <dt class="govuk-summary-list__value">
          <%= @current_case.savings_estimate %>
        </dt>
      </div>
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">
          <%= I18n.t("support.case.label.procurement_details.savings_actual") %>
        </dt>
        <dt class="govuk-summary-list__value">
          <%= @current_case.savings_actual %>
        </dt>
      </div>
    </dl>
  </div>
</div>
