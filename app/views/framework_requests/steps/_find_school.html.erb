<%= content_for :title, I18n.t("faf.search_for_a_school.title") %>

<span class="govuk-caption-l">
  <%= I18n.t("faf.search_for_a_school.caption") %>
</span>
<h1 class="govuk-heading-l">
  <%= I18n.t("faf.search_for_a_school.heading") %>
</h1>

<%= render "components/autocomplete",
      container_id: "framework-request-form-school-urn-field",
      label_text: I18n.t("faf.search_for_a_school.hint"),
      label_class: "govuk-hint",
      element_id: "framework-support-form-school-urn-field",
      element_name: "framework_support_form[school_urn]",
      template_suggestion: "{{urn}}, <strong>{{name}}</strong>, {{postcode}}",
      value_field: :formatted_name,
      default_value: form.object.school_urn,
      query_url: support_organisations_path(format: :json, q: "{{QUERY}}") %>

<details class="govuk-details" data-module="govuk-details">
  <summary class="govuk-details__summary">
    <span class="govuk-details__summary-text">
      <%= I18n.t("faf.search_for_a_school.details.summary") %>
    </span>
  </summary>

  <%
    text = I18n.t "faf.search_for_a_school.details.search_for_a_group_link"

    link =
      if @framework_request&.persisted?
        link_to text, edit_framework_request_path(@framework_request, step: 3, group: true), class: "govuk-link"
      else
        link_to text, framework_requests_path(framework_support_form: form.object.find_group), method: :post, class: "govuk-link"
      end

    for body in I18n.t "faf.search_for_a_school.details.body", search_for_a_group_link: link
  %>
    <div class="govuk-details__text">
      <%= body.html_safe %>
    </div>
  <% end %>
</details>
