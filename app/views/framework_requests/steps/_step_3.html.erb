<%# school lookup for guests or selection for users (3) %>

<%= form.hidden_field :dsi, value: form.object.dsi  %>
<%= form.hidden_field :group, value: form.object.group %>

<% if current_user.guest? %>
  <%=
    template = @form.group ? "find_group" : "find_school"
    render "framework_requests/steps/#{template}", form: form
  %>
<% else %>
  <%= content_for :title, I18n.t("faf.user_organisation.header") %>

  <%= form.govuk_radio_buttons_fieldset(:org_id, caption: { text: I18n.t("faf.which_school.caption"), size: "l" }, legend: { text: I18n.t("faf.which_school.legend"), size: "l" }) do %>
      <% form.object.user.supported_orgs.each do |org| %>
        <% if org.urn %>
          <%= form.govuk_radio_button :school_urn, org.urn, label: { text: org.name } %>
        <% else %>
          <%= form.govuk_radio_button :group_uid, org.uid, label: { text: org.name } %>
        <% end %>
      <% end %>
  <% end %>

  <%= javascript_include_tag "faf_select_school" %>
<% end %>
