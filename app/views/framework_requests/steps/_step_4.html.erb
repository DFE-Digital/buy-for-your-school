<!-- school lookup for guests or selection for users (4)  -->

<%= form.hidden_field :dsi %>
<%= form.hidden_field :first_name, value: form.object.first_name %>
<%= form.hidden_field :last_name, value: form.object.last_name %>
<%= form.hidden_field :email, value: form.object.email %>

<% if !current_user.guest? %>
  <%= content_for :title, I18n.t("faf.user_organisation.header") %>

  <%= form.govuk_collection_radio_buttons :school_urn,
    current_user.supported_schools,
    :urn,
    :name,
    caption: { text: I18n.t("support_request.caption.school"), size: "l" },
    legend: { text: I18n.t("support_request.caption.school"), size: "l" },
    hint: { text: I18n.t("support_request.caption.school") }
  %>
<% else %>
  <%= content_for :title, I18n.t("faf.search_for_a_school.title") %>

  <span class="govuk-caption-l"><%= I18n.t("faf.search_for_a_school.caption") %></span>
  <h1 class="govuk-heading-l"><%= I18n.t("faf.search_for_a_school.heading") %></h1>

  <%= render "components/autocomplete",
        container_id: "framework-request-form-school-urn-field",
        label_text: I18n.t("faf.search_for_a_school.hint"),
        label_class: "govuk-hint",
        element_id: "framework-support-form-school-urn-field",
        element_name: "framework_support_form[school_urn]",
        template_suggestion: "{{urn}}, <strong>{{name}}</strong>, {{postcode}}",
        value_field: :formatted_name,
        default_value: "#{@framework_support_form.school_urn}",
        query_url: support_organisations_path(format: :json, q: "{{QUERY}}") %>

  <details class="govuk-details" data-module="govuk-details">
    <summary class="govuk-details__summary">
      <span class="govuk-details__summary-text">
        <%= I18n.t("faf.search_for_a_school.details.summary") %>
      </span>
    </summary>

    <% for body in I18n.t("faf.search_for_a_school.details.body") %>
      <div class="govuk-details__text">
        <%= body %>
      </div>
    <% end %>
  </details>
<% end %>
