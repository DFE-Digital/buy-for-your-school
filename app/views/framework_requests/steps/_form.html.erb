
<% if @framework_request&.persisted? %>
  <%= link_to I18n.t("generic.button.back"), framework_request_path(@framework_request), class: "govuk-back-link" %>
<% elsif @form.position?(1) %>
  <%= link_to I18n.t("generic.button.back"), framework_requests_path, class: "govuk-back-link"  %>
<% else %>
  <%= link_to I18n.t("generic.button.back"), framework_requests_path(framework_support_form: @form.go_back), method: :post, class: "govuk-back-link" %>
<% end %>

<%= form_with model: @form, scope: :framework_support_form, url: path, method: verb  do |form| %>
  <%= form.govuk_error_summary %>

  <%= form.hidden_field :step, value: @form.step %>
  <%= render "framework_requests/steps/step_#{@form.step}", form: form %>

  <%= form.submit I18n.t("generic.button.next"), class: "govuk-button", role: "button" %>
<% end %>

<% if Rails.env.development? %>
  <%= debug @framework_request&.attributes %>
  Step
  <%= debug @form.step %>
  Supported Schools
  <%= debug @form.user.supported_schools %>
  Input
  <%= debug @form.to_h.except(:user) %>
  Output
  <%= debug @form.data %>
  School
  <%= debug @organisation&.attributes %>
  Group
  <%= debug @establishment_group&.attributes %>
<% end %>
