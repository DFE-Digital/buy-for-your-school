<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: CHANGELOG
  
    &mdash; Documentation by YARD 0.9.26
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "CHANGELOG";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="file_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: CHANGELOG</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'>
<h1 id="label-Changelog">Changelog</h1>

<p>All notable changes to this project will be documented in this file.</p>

<p>The format is based on [Keep a Changelog 1.0.0].</p>

<h2 id="label-5BUnreleased-5D">[Unreleased]</h2>

<h3 id="label-Supported+Unreleased">Supported Unreleased</h3>
<ul><li>
<p>add initial models for supported case management functions</p>
</li><li>
<p>add unique 6 digit ref for cases starting with 000001</p>
</li><li>
<p>add service to create SupportCases from SupportEnquiries</p>
</li><li>
<p>add ability for agent to resolve a case with notes</p>
</li><li>
<p>add ability for agent to send a non templated email on a case</p>
</li><li>
<p>add ability for agent to send templated emails on a case</p>
</li><li>
<p>add ability for agent to view specification</p>
</li><li>
<p>privacy notice page</p>
</li><li>
<p>accessibility page</p>
</li><li>
<p>add link to school details in GIAS from case view</p>
</li><li>
<p>add ability to re-categorise a case</p>
</li></ul>

<h3 id="label-Specify+Unreleased">Specify Unreleased</h3>

<p><strong>Infrastructure</strong></p>
<ul><li>
<p>Contentful env <code>master</code> is now aliased to <code>staging</code></p>
</li><li>
<p>Contentful env <code>research</code> has been removed</p>
</li><li>
<p><code>production</code> points to Contentful <code>master</code></p>
</li><li>
<p><code>staging</code> points to Contentful <code>staging</code></p>
</li><li>
<p>Github actions changed to clone <code>staging</code> to <code>develop</code> for local development</p>
</li></ul>

<p><strong>ITHC</strong></p>
<ul><li>
<p>explicitly set <code>X-Xss-Protection</code> header</p>
</li><li>
<p>restrict all <code>robots.txt</code></p>
</li></ul>

<p><strong>Support Requests</strong></p>
<ul><li>
<p>add form to request support</p>
</li><li>
<p>use <code>dry-validation</code> for complex form validations</p>
</li><li>
<p>provide a better more accessible user experience using the form error summary</p>
</li><li>
<p>send a confirmation email upon submission</p>
</li></ul>

<p><strong>Rich Data</strong></p>
<ul><li>
<p>integrate fully with DSI to gather names, email and organisation at authentication</p>
</li><li>
<p>add env vars for DSI API <code>DFE_SIGN_IN_API_SECRET</code>, <code>DFE_SIGN_IN_API_ENDPOINT</code></p>
</li><li>
<p>make a post authentication API call to DSI for roles and organisations information</p>
</li><li>
<p>register localhost with DSI for callbacks in development</p>
</li><li>
<p>document DSI changes including creation of SSL self-certs required in development</p>
</li><li>
<p>integrate with GIAS by downloading and manipulating data in CSV format</p>
</li><li>
<p>include capacity to export GIAS data as <code>YAML</code> or <code>JSON</code> for later use</p>
</li><li>
<p>validate and coerce data using <code>dry-schema</code> and <code>dry-transformer</code></p>
</li><li>
<p>introduce a <code>Guest</code> entity using <code>dry-struct</code> to assist with RBAC</p>
</li><li>
<p>replace <code>FindOrCreateUserfromSession</code> with <code>CreateUser</code> and <code>CurrentUser</code> functions</p>
</li><li>
<p>add strict typing into new functional service objects using <code>dry-types</code></p>
</li><li>
<p>add <code>foreman</code> as an optional convenience in development</p>
</li><li>
<p>store identifying information for a <code>User</code></p>
</li><li>
<p>display signed in user&#39;s name in header bar</p>
</li><li>
<p>grant access to supported organisations and ProcOps users only</p>
</li></ul>

<p><strong>House keeping</strong></p>
<ul><li>
<p>bump Ruby to version <code>3.0.1</code></p>
</li><li>
<p>document code using Yard</p>
</li><li>
<p>use CodeClimate in CI pipeline to highlight areas of improvement</p>
</li><li>
<p>change from <code>standardrb</code> to <code>rubocop-govuk</code> and convert lint style</p>
</li><li>
<p>generate PDF format Entity Relationship Diagram with upon DB migrations</p>
</li><li>
<p>add status badges to <code>README</code></p>
</li><li>
<p>use <code>pry</code> in the Rails console</p>
</li><li>
<p>add additional developer tools to optional <code>Brewfile</code></p>
</li><li>
<p>remove unused <code>GetAllContentfulEntries</code> service object</p>
</li><li>
<p>change route to destroy a session to be DELETE</p>
</li><li>
<p>separate out concern for stale journeys and their removal <code>FlagStaleJourneysJob</code>,  currently no-op until approved</p>
</li><li>
<p>clean and fix deletion of stale journeys <code>DeleteStaleJourneysJob</code>, currently  no-op until approved</p>
</li></ul>

<p><strong>Steps</strong></p>
<ul><li>
<p>implement <strong>interrupt pattern</strong> which introduces a step that is not semantically  a question but a statement</p>
</li><li>
<p>remove <code>staticContent</code> entity and add <code>Statement</code> entity in Contentful (staging only)</p>
</li><li>
<p>add custom answer validation logic which can be controlled in Contentful</p>
</li><li>
<p>fix progression to the next incomplete task</p>
</li><li>
<p>add <code>skipped_ids</code> to <code>Task</code> to allow users to skip questions</p>
</li><li>
<p>add error summary component</p>
</li><li>
<p>customise presence validation message</p>
</li><li>
<p>provide qualtrics feedback (saved in QUALTRICS_SURVEY_URL env)</p>
</li></ul>

<p><strong>Multiple Categories</strong></p>
<ul><li>
<p>remove references to <code>CONTENTFUL_DEFAULT_CATEGORY_ENTRY_ID</code></p>
</li><li>
<p>introduce <code>Category</code> model to mirror Contentful category entity</p>
</li><li>
<p>add category <code>title</code> column to the dashboard</p>
</li><li>
<p>add <code>journey_maps#index</code> to allow content designers to switch category</p>
</li><li>
<p>add <code>categories#index</code> to enable users to create a specification from a chosen category</p>
</li><li>
<p>rename <code>journey_maps</code> to <code>design</code> to allow more intuitive URLs</p>
</li><li>
<p>WIP: data migration</p>
</li><li>
<p>update Contentful webhook handling to pick up updates to <code>Category</code> when they are published</p>
</li></ul>

<p><strong>Dashboard functionality</strong></p>
<ul><li>
<p>add explicit ordering to the task model to allow continuing to the next unanswered task</p>
</li><li>
<p>add extensible tally of counted steps to the task</p>
</li><li>
<p>add state to <code>Journey</code> (initial, stale, archive or remove)</p>
</li><li>
<p>drop <code>Journey.last_worked_on</code> in favour of <code>updated_at</code></p>
</li><li>
<p>allow user to (soft) delete a specification</p>
</li></ul>

<p><strong>Preview functionality</strong></p>
<ul><li>
<p>previously this depended upon a dedicated environment which used the main branch  thereby preventing preview functionality in staging</p>
</li><li>
<p>a memoised client for both Contentful delivery and preview is available for any environment</p>
</li><li>
<p><code>Content::Connector</code> instantiates both clients</p>
</li><li>
<p><code>Content::Client</code> is used internally as an interface to the Contentful ruby gem</p>
</li><li>
<p><code>APP_ENV_{ENV}_CONTENTFUL_ACCESS_TOKEN</code> is replaced by  <code>APP_ENV_{ENV}_CONTENTFUL_DELIVERY_TOKEN</code> and <code>APP_ENV_{ENV}_CONTENTFUL_PREVIEW_TOKEN</code></p>
</li></ul>

<h2 id="label-Diary+Studies+using+the+live+environment">Diary Studies using the live environment</h2>

<h2 id="label-release-015+-+2021-06-17"><a href="https://github.com/DFE-Digital/buy-for-your-school/compare/release-014...release-015">release-015</a> - 2021-06-17</h2>
<ul><li>
<p>always show task title even if it contains a single step</p>
</li><li>
<p>replace journeys_path with a unified dashboard</p>
</li><li>
<p>replace back to task list button with a link</p>
</li><li>
<p>add button to continue completing the current task</p>
</li><li>
<p>add button to continue to the next incomplete task if the current is complete</p>
</li><li>
<p>track key user actions throughout the journey</p>
</li></ul>

<h2 id="label-release-014+-+2021-05-20"><a href="https://github.com/DFE-Digital/buy-for-your-school/compare/release-013...release-014">release-014</a> - 2021-05-20</h2>
<ul><li>
<p>remove now unused GetStepFromSection service to complete code migration to get steps from tasks</p>
</li><li>
<p>answering steps in a task may take you to the next step unless you&#39;ve answered them all</p>
</li><li>
<p>tasks with no answers take the user straight to the first question instead of the task page</p>
</li><li>
<p>swap task view pattern for the check your answers pattern</p>
</li></ul>

<h2 id="label-release-013+-+2021-05-18"><a href="https://github.com/DFE-Digital/buy-for-your-school/compare/release-012...release-013">release-013</a> - 2021-05-18</h2>
<ul><li>
<p>prevent random CI failures due to missing Redis connections</p>
</li><li>
<p>GitHub action that allows manual cloning from master to staging with one-click for content testing</p>
</li><li>
<p>steps are listed in the order set in Contentful rather than database insert order</p>
</li></ul>

<h2 id="label-release-012+-+2021-05-11"><a href="https://github.com/DFE-Digital/buy-for-your-school/compare/release-011...release-012">release-012</a> - 2021-05-11</h2>
<ul><li>
<p>sections are listed in the order set in Contentful rather than database insert order</p>
</li><li>
<p>fix github secret limit by moving from repo secrets to environment secrets</p>
</li></ul>

<h2 id="label-release-011+-+2021-05-10"><a href="https://github.com/DFE-Digital/buy-for-your-school/compare/release-010...release-011">release-011</a> - 2021-05-10</h2>
<ul><li>
<p>error pages are styled</p>
</li><li>
<p>document how to manage live environment variables</p>
</li><li>
<p>Update all fixtures to include tasks</p>
</li><li>
<p>Update the specs to work with the new task-enabled fixtures</p>
</li><li>
<p>Remove <code>Journey#section_groups</code> and sever the direct Journey -&gt; Steps association</p>
</li><li>
<p>tasks now have their completion status indicated on the task list</p>
</li></ul>

<h2 id="label-release-010+-+2021-04-27"><a href="https://github.com/DFE-Digital/buy-for-your-school/compare/release-009...release-010">release-010</a> - 2021-04-27</h2>
<ul><li>
<p>add header and footer information for feedback and data requests</p>
</li><li>
<p>force SSL in production to only accept HTTPS traffic, enable HSTS and secure tower cookies</p>
</li><li>
<p>prevent concurrent sign ins</p>
</li><li>
<p>Create Task model; fetch tasks from Contentful and create them in the  database.</p>
</li><li>
<p>Break direct association between Journey and Steps. Create new association  between Tasks and Steps.</p>
</li><li>
<p>Show Tasks on Journey page; clicking on a Task name takes you to a task page.</p>
</li><li>
<p>Show Steps on Task page and allow users to answer questions from Task page</p>
</li><li>
<p>fix CI not running RSpec</p>
</li><li>
<p>existing specification page displays useful message when no specs exist</p>
</li><li>
<p>fix text input field width to fit full screen width</p>
</li><li>
<p>document where to find the service in the readme</p>
</li><li>
<p>cache CI builds to reduce build times</p>
</li><li>
<p>log information about contentful cache busting webhooks for debugging</p>
</li></ul>

<h2 id="label-release-009+-+2021-04-21"><a href="https://github.com/DFE-Digital/buy-for-your-school/compare/release-008...release-009">release-009</a> - 2021-04-21</h2>
<ul><li>
<p>fix multiple specification fields</p>
</li><li>
<p>content security policy</p>
</li><li>
<p>remove humans.txt</p>
</li></ul>

<h2 id="label-release-008+-+2021-04-19"><a href="https://github.com/DFE-Digital/buy-for-your-school/compare/release-007...release-008">release-008</a> - 2021-04-19</h2>
<ul><li>
<p>auto deploy research and preview environments</p>
</li></ul>

<h2 id="label-release-007+-+2021-04-19"><a href="https://github.com/DFE-Digital/buy-for-your-school/compare/release-006...release-007">release-007</a> - 2021-04-19</h2>
<ul><li>
<p>Add <code>noindex,nofollow</code> meta tag to all pages, as per Gov.UK guidance</p>
</li><li>
<p>fix API auth by switching mechanism from Basic to Token</p>
</li><li>
<p>remove <code>Returning to this specification</code> URL from task list</p>
</li><li>
<p>Add Tasks to the database when iterating through Sections from Contentful</p>
</li><li>
<p>fix XSS vulnerability by sanitising all user answers</p>
</li><li>
<p>support specification templates that exceed 50,000 characters in Contentful</p>
</li></ul>

<h2 id="label-release-006+-+2021-04-01"><a href="https://github.com/DFE-Digital/buy-for-your-school/compare/release-005...release-006">release-006</a> - 2021-04-01</h2>
<ul><li>
<p>specification templates are now sourced from the Contentful Category entry</p>
</li><li>
<p>refactor how we find all journey answers into isolated service</p>
</li><li>
<p>users are now told how they can resume a journey, and an address is provided for this</p>
</li><li>
<p>robots.txt now excludes all journey and step pages</p>
</li><li>
<p>steps/questions/tasks in the task lists are now grouped by Contentful Section entries</p>
</li><li>
<p>start page now has revised copy with details on eligibility and what to expect</p>
</li><li>
<p>The journey map is now clearer about what happens when you click a link</p>
</li><li>
<p>The journey map now includes links to preview a step</p>
</li><li>
<p>The journey map now displays markup to include a step&#39;s answer in the specification template</p>
</li><li>
<p>users can answer questions which expect a number</p>
</li><li>
<p>checkbox questions no longer alter the capitalisation of options</p>
</li><li>
<p>fix ordering of section and step items</p>
</li><li>
<p>users can answer questions which expect a currency</p>
</li><li>
<p>questions can be hidden from view</p>
</li><li>
<p>specification warning if there are incomplete tasks</p>
</li><li>
<p>hidden questions can be shown through a new show_additional_question field for each question</p>
</li><li>
<p>hidden questions can be rehidden again after changing the original answer</p>
</li><li>
<p>hidden questions that were at one point answered, will be reshown with a change to an earlier question</p>
</li><li>
<p>fix Redis connection errors on Heroku</p>
</li><li>
<p>users can be asked extended checkbox questions which ask for further information</p>
</li><li>
<p>markdown in help text fields is now parsed into HTML</p>
</li><li>
<p>show and hide more than one additional question at a time</p>
</li><li>
<p>users can be presenting with forking/branching question chains based on any one answer</p>
</li><li>
<p>create an extended further information text box option for radio answers</p>
</li><li>
<p>create extended further information text box option for checkbox answers</p>
</li><li>
<p>radio questions can be configured with an “or” separator</p>
</li><li>
<p>specification can show further information for radio answers</p>
</li><li>
<p>specification can show further information for checkbox answers</p>
</li><li>
<p>checkbox answers can be completed without choosing a given answer</p>
</li><li>
<p>fix planning page link back to the service</p>
</li><li>
<p>checkbox answers are not automatically joined by commas for the specification</p>
</li><li>
<p>answer data is all available through the single <code>answer_x</code> convention, this has replaced <code>extended_answer_x</code> which has now been removed</p>
</li><li>
<p>checkbox answers that are skipped can be identified in the specification</p>
</li><li>
<p>fix branching so multiple rules can show the same question</p>
</li><li>
<p>the specification lives on it&#39;s own page, separate to the task list</p>
</li><li>
<p>fix checkbox questions where further information couldn&#39;t be saved for an option that included a special character</p>
</li><li>
<p>further information for options that include special characters is now available to the specification</p>
</li><li>
<p>incomplete specification documents include a warning within the document as well as the file name</p>
</li><li>
<p>users return to the same place in the task list after answering a question</p>
</li><li>
<p>fix extended radio questions so that further_information can be remembered when it can be provided through multiple fields</p>
</li><li>
<p>flash messages can be shown in notification banners</p>
</li><li>
<p>fix checkbox answer to save choices after previously skipping</p>
</li><li>
<p>users can sign in using DfE Sign-in</p>
</li><li>
<p>users can sign out using DfE Sign-in</p>
</li><li>
<p>add new dashboard page with the ability to create new specifications</p>
</li><li>
<p>users can only see their past journeys from the dashboard</p>
</li><li>
<p>new API endpoint to allow Contentful to invalidate cached entries, allowing caching to stay on which prevents the app from being very slow/crashing on journey start</p>
</li><li>
<p>automatically delete Journey and associated records if we deem it to have become stale, to reclaim the unused database rows</p>
</li></ul>

<h2 id="label-release-005+-+2021-1-19"><a href="https://github.com/DFE-Digital/buy-for-your-school/compare/release-004...release-005">release-005</a> - 2021-1-19</h2>
<ul><li>
<p>users can see an initial slice of their specification as HTML at the end of their journey</p>
</li><li>
<p>users can download their specification as a document in the .docx format</p>
</li><li>
<p>checkbox answers are editable</p>
</li><li>
<p>radio and select questions are created with the new <code>ExtendedOptions</code> field</p>
</li><li>
<p>questions are now all loaded at the start of a journey, rather than step by step</p>
</li><li>
<p>users start the journey at the task list instead of the first question</p>
</li><li>
<p>check your answers pattern has been replaced by a task list</p>
</li><li>
<p>radio questions can be configured to ask the user for additional text</p>
</li><li>
<p>update the service name to the latest decision</p>
</li></ul>

<h2 id="label-release-004+-+2020-12-17"><a href="https://github.com/DFE-Digital/buy-for-your-school/compare/release-003...release-004">release-004</a> - 2020-12-17</h2>
<ul><li>
<p>fix primary key type on long_text_answers table to UUID</p>
</li><li>
<p>nightly task to warm the Contentful cache for all entries</p>
</li><li>
<p>form button content is configurable through Contentful</p>
</li><li>
<p>users can be asked to provide a single date answer</p>
</li><li>
<p>add Webmock to prevent real http requests in the test suite</p>
</li><li>
<p>content users can see a journey map of all the Contentful steps</p>
</li><li>
<p>users can be asked to provide multiple answers via a checkbox question</p>
</li><li>
<p>journey map shows an error to the content team if a duplicate entry is detected</p>
</li><li>
<p>journey map shows an error to the content team if the journey doesn&#39;t end within 50 steps</p>
</li><li>
<p>refactor how we store and access a Step&#39;s associated Contentful Entry ID</p>
</li><li>
<p>users can edit their answers</p>
</li><li>
<p>only add Contentful entries that form part of a valid journey to the cache</p>
</li></ul>

<h2 id="label-release-003+-+2020-12-07"><a href="https://github.com/DFE-Digital/buy-for-your-school/compare/release-002...release-003">release-003</a> - 2020-12-07</h2>
<ul><li>
<p>add database foreign key constraints for better data integrity</p>
</li><li>
<p>Contentful entry requests use a new Redis read cache</p>
</li><li>
<p>service name included in the header</p>
</li><li>
<p>refactor name of “Plan” to “Journey”</p>
</li><li>
<p>refactor name of “Question” to “Step”</p>
</li><li>
<p>refactor redis caching into reusable class</p>
</li><li>
<p>users can be shown a step in the journey that is only static content</p>
</li></ul>

<h2 id="label-release-002+-+2020-11-16"><a href="https://github.com/DFE-Digital/buy-for-your-school/compare/release-001...release-002">release-002</a> - 2020-11-16</h2>
<ul><li>
<p>migrate answer database table into Radio and ShortText</p>
</li></ul>

<h2 id="label-release-001+-+2020-11-12"><a href="https://github.com/DFE-Digital/buy-for-your-school/compare/release-000...release-001">release-001</a> - 2020-11-12</h2>
<ul><li>
<p>address rails-template TODO</p>
</li><li>
<p>any user can see a start page for the specifying journey</p>
</li><li>
<p>use GOV.UK Frontend framework</p>
</li><li>
<p>users can see a basic form to start the specifying journey sourced by a  Contentful fixture</p>
</li><li>
<p>specifying form is styled as a GOV.UK form</p>
</li><li>
<p>validate that an answer is provided to a question</p>
</li><li>
<p>the first specifying question comes directly from Contentful</p>
</li><li>
<p>handle the exceptional case when a Contentful entry is missing</p>
</li><li>
<p>multiple radio questions can be answered in sequence</p>
</li><li>
<p>users can be asked to answer a short text question</p>
</li><li>
<p>Contentful can redirect users to preview endpoints</p>
</li><li>
<p>users can be asked to answer a long text question</p>
</li></ul>
</div></div>

      <div id="footer">
  Generated on Mon Nov  8 13:21:32 2021 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.26 (ruby-3.0.1).
</div>

    </div>
  </body>
</html>